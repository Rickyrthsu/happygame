<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>打字戰鬥機</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Noto+Sans+TC:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #0a0a0a;
            color: #e0e0e0;
            overflow: hidden;
        }

        .game-font {
            font-family: 'Press Start 2P', cursive;
        }

        #gameCanvas {
            background: #000 url('data:image/svg+xml,%3Csvg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3z" fill="%231a1a1a" fill-opacity="0.4" fill-rule="evenodd"/%3E%3C/svg%3E');
            cursor: text;
            display: block;
        }
        
        #waveAnnouncer {
            transform: translateX(-100%);
            transition: transform 0.5s ease-in-out;
        }
        #waveAnnouncer.show {
            transform: translateX(0);
        }

        #completed-words-list::-webkit-scrollbar {
            width: 8px;
        }
        #completed-words-list::-webkit-scrollbar-track {
            background: #2d3748;
        }
        #completed-words-list::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 4px;
        }
        #completed-words-list::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }

        /* Screen Shake Animation */
        @keyframes screenShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); } /* Reduced shake */
            20%, 40%, 60%, 80% { transform: translateX(3px); }  /* Reduced shake */
        }

        .shake {
            animation: screenShake 0.3s;
        }
    </style>
</head>
<body class="flex items-center justify-center h-screen bg-gray-900">

    <div class="flex flex-row items-stretch justify-center gap-8 p-4 h-[95vh] max-h-[1000px] w-full">
        <!-- Left Panel for Current Word -->
        <div id="wordInfoPanel" class="w-80 p-6 bg-gray-800 border-4 border-gray-700 rounded-lg flex flex-col justify-center text-center">
            <h3 class="text-2xl game-font text-cyan-400 mb-4">目前目標</h3>
            <p id="info-word" class="text-5xl text-yellow-300 break-words min-h-[5rem]">---</p>
            <p id="info-translation" class="text-3xl text-white mt-2 min-h-[3.5rem]">---</p>
        </div>

        <!-- Game Container -->
        <div id="gameContainer" class="w-full max-w-lg aspect-[3/5] relative rounded-lg shadow-2xl shadow-cyan-500/50 border-4 border-cyan-400/50 bg-black overflow-hidden">
            <canvas id="gameCanvas"></canvas>

            <!-- 遊戲資訊介面 -->
            <div class="absolute top-4 left-4 text-white game-font text-base flex items-center gap-4">
                <div id="playerHealth"></div>
                <span>分數: <span id="score">0</span></span>
            </div>
            <div class="absolute top-4 right-4 text-white game-font text-base text-right">
                <div>關卡: <span id="wave">1</span></div>
                <div class="mt-1 text-sm">最高分: <span id="highScore">0</span></div>
            </div>
            <div id="comboDisplay" class="absolute bottom-4 left-4 text-yellow-400 game-font text-lg">
                連擊: <span id="combo-streak">0</span>
            </div>

            <!-- 暫停畫面 -->
            <div id="pauseOverlay" class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
                <h2 class="text-5xl text-yellow-400 game-font animate-pulse">PAUSED</h2>
            </div>
            
            <!-- 關卡跑馬燈 -->
            <div id="waveAnnouncer" class="absolute top-1/2 left-0 w-full bg-yellow-400 bg-opacity-80 text-center py-4 -translate-y-1/2">
                <h2 id="waveText" class="text-4xl text-gray-900 game-font"></h2>
            </div>
            
            <!-- Error Flash Overlay -->
            <div id="flashOverlay" class="absolute inset-0 bg-red-500 opacity-0 transition-opacity duration-100 pointer-events-none"></div>

            <!-- 遊戲開始/結束彈窗 -->
            <div id="messageModal" class="absolute inset-0 bg-black bg-opacity-70 flex items-center justify-center">
                <div class="text-center game-font p-4">
                    <h2 id="messageTitle" class="text-4xl mb-4 text-yellow-400"></h2>
                    <p id="messageText" class="text-lg mb-8 leading-relaxed text-left max-w-md"></p>
                    <button id="actionButton" class="bg-cyan-500 hover:bg-cyan-400 text-gray-900 font-bold py-3 px-8 rounded-lg transition-transform transform hover:scale-105 text-2xl">
                        開始遊戲
                    </button>
                </div>
            </div>
        </div>

        <!-- Right Panel for Completed Words -->
        <div id="completedWordsPanel" class="w-72 p-6 bg-gray-800 border-4 border-gray-700 rounded-lg flex flex-col">
            <div class="flex-grow flex flex-col min-h-0">
                <h3 class="text-lg game-font text-cyan-400 mb-2 text-center">擊落紀錄</h3>
                <div id="completed-words-list" class="flex-grow overflow-y-auto pr-2 space-y-2">
                    <!-- Completed words will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>
    <a href="./index.html" class="fixed bottom-5 right-5 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-colors z-10">
        返回
    </a>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const gameContainer = document.getElementById('gameContainer');

        const scoreEl = document.getElementById('score');
        const waveEl = document.getElementById('wave');
        const playerHealthEl = document.getElementById('playerHealth');
        const highScoreEl = document.getElementById('highScore');
        const comboStreakEl = document.getElementById('combo-streak');
        
        const messageModal = document.getElementById('messageModal');
        const messageTitle = document.getElementById('messageTitle');
        const messageText = document.getElementById('messageText');
        let actionButton = document.getElementById('actionButton');
        
        const pauseOverlay = document.getElementById('pauseOverlay');
        const waveAnnouncer = document.getElementById('waveAnnouncer');
        const waveText = document.getElementById('waveText');
        const flashOverlay = document.getElementById('flashOverlay');

        const infoWordEl = document.getElementById('info-word');
        const infoTranslationEl = document.getElementById('info-translation');
        const completedWordsListEl = document.getElementById('completed-words-list');

        let player, enemies, bullets, particles, drones, droneLasers;
        let score, wave, isGameOver, isGameRunning, currentTarget, isPaused;
        let highScore = 0;
        let comboWordStreak = 0;
        let comboKeyStreak = 0;
        
        // ==================================================================
        // --- 在這裡貼上你的 allWords 陣列 ---
         const allWords = [
          { "word": "act", "translation": "行動", "level": 1 }, { "word": "age", "translation": "年齡", "level": 1 }, { "word": "air", "translation": "空氣", "level": 1 }, { "word": "art", "translation": "藝術", "level": 1 }, { "word": "bag", "translation": "袋子", "level": 1 }, { "word": "box", "translation": "盒子", "level": 1 }, { "word": "boy", "translation": "男孩", "level": 1 }, { "word": "bus", "translation": "公車", "level": 1 }, { "word": "buy", "translation": "購買", "level": 1 }, { "word": "car", "translation": "車", "level": 1 }, { "word": "cat", "translation": "貓", "level": 1 }, { "word": "dog", "translation": "狗", "level": 1 }, { "word": "eat", "translation": "吃", "level": 1 }, { "word": "egg", "translation": "蛋", "level": 1 }, { "word": "eye", "translation": "眼睛", "level": 1 }, { "word": "fly", "translation": "飛", "level": 1 }, { "word": "go", "translation": "去", "level": 1 }, { "word": "hat", "translation": "帽子", "level": 1 }, { "word": "hot", "translation": "熱的", "level": 1 }, { "word": "ice", "translation": "冰", "level": 1 }, { "word": "job", "translation": "工作", "level": 1 }, { "word": "key", "translation": "鑰匙", "level": 1 }, { "word": "leg", "translation": "腿", "level": 1 }, { "word": "man", "translation": "男人", "level": 1 }, { "word": "map", "translation": "地圖", "level": 1 }, { "word": "new", "translation": "新的", "level": 1 }, { "word": "pen", "translation": "筆", "level": 1 }, { "word": "run", "translation": "跑", "level": 1 }, { "word": "sun", "translation": "太陽", "level": 1 }, { "word": "tea", "translation": "茶", "level": 1 }, { "word": "toy", "translation": "玩具", "level": 1 }, { "word": "use", "translation": "使用", "level": 1 },
          { "word": "able", "translation": "能夠的", "level": 2 }, { "word": "area", "translation": "區域", "level": 2 }, { "word": "army", "translation": "軍隊", "level": 2 }, { "word": "baby", "translation": "嬰兒", "level": 2 }, { "word": "back", "translation": "後面", "level": 2 }, { "word": "ball", "translation": "球", "level": 2 }, { "word": "band", "translation": "樂團", "level": 2 }, { "word": "bank", "translation": "銀行", "level": 2 }, { "word": "base", "translation": "基礎", "level": 2 }, { "word": "bird", "translation": "鳥", "level": 2 }, { "word": "blue", "translation": "藍色", "level": 2 }, { "word": "boat", "translation": "船", "level": 2 }, { "word": "body", "translation": "身體", "level": 2 }, { "word": "book", "translation": "書", "level": 2 }, { "word": "burn", "translation": "燃燒", "level": 2 }, { "word": "busy", "translation": "忙碌的", "level": 2 }, { "word": "cake", "translation": "蛋糕", "level": 2 }, { "word": "call", "translation": "呼叫", "level": 2 }, { "word": "camp", "translation": "露營", "level": 2 }, { "word": "card", "translation": "卡片", "level": 2 }, { "word": "care", "translation": "關心", "level": 2 }, { "word": "city", "translation": "城市", "level": 2 }, { "word": "club", "translation": "社團", "level": 2 }, { "word": "code", "translation": "程式碼", "level": 2 }, { "word": "cold", "translation": "冷的", "level": 2 }, { "word": "cook", "translation": "烹飪", "level": 2 }, { "word": "dark", "translation": "黑暗的", "level": 2 }, { "word": "date", "translation": "日期", "level": 2 }, { "word": "desk", "translation": "書桌", "level": 2 }, { "word": "door", "translation": "門", "level": 2 }, { "word": "draw", "translation": "畫", "level": 2 }, { "word": "dream", "translation": "夢", "level": 2 }, { "word": "drive", "translation": "開車", "level": 2 }, { "word": "easy", "translation": "簡單的", "level": 2 }, { "word": "exam", "translation": "考試", "level": 2 }, { "word": "face", "translation": "臉", "level": 2 }, { "word": "fact", "translation": "事實", "level": 2 }, { "word": "farm", "translation": "農場", "level": 2 }, { "word": "feel", "translation": "感覺", "level": 2 }, { "word": "film", "translation": "電影", "level": 2 }, { "word": "find", "translation": "找到", "level": 2 }, { "word": "fire", "translation": "火", "level": 2 }, { "word": "fish", "translation": "魚", "level": 2 }, { "word": "food", "translation": "食物", "level": 2 }, { "word": "foot", "translation": "腳", "level": 2 }, { "word": "game", "translation": "遊戲", "level": 2 }, { "word": "girl", "translation": "女孩", "level": 2 }, { "word": "give", "translation": "給", "level": 2 }, { "word": "glass", "translation": "玻璃", "level": 2 }, { "word": "goal", "translation": "目標", "level": 2 }, { "word": "gold", "translation": "黃金", "level": 2 }, { "word": "good", "translation": "好的", "level": 2 }, { "word": "green", "translation": "綠色", "level": 2 }, { "word": "grow", "translation": "成長", "level": 2 }, { "word": "hand", "translation": "手", "level": 2 }, { "word": "hard", "translation": "困難的", "level": 2 }, { "word": "have", "translation": "有", "level": 2 }, { "word": "head", "translation": "頭", "level": 2 }, { "word": "hear", "translation": "聽到", "level": 2 }, { "word": "help", "translation": "幫助", "level": 2 }, { "word": "home", "translation": "家", "level": 2 }, { "word": "hope", "translation": "希望", "level": 2 }, { "word": "hour", "translation": "小時", "level": 2 }, { "word": "idea", "translation": "點子", "level": 2 }, { "word": "join", "translation": "加入", "level": 2 }, { "word": "jump", "translation": "跳", "level": 2 }, { "word": "keep", "translation": "保持", "level": 2 }, { "word": "kind", "translation": "種類", "level": 2 }, { "word": "king", "translation": "國王", "level": 2 }, { "word": "know", "translation": "知道", "level": 2 }, { "word": "land", "translation": "陸地", "level": 2 }, { "word": "large", "translation": "大的", "level": 2 },
          { "word": "learn", "translation": "學習", "level": 3 }, { "word": "leave", "translation": "離開", "level": 3 }, { "word": "letter", "translation": "信；字母", "level": 3 }, { "word": "light", "translation": "光；輕的", "level": 3 }, { "word": "listen", "translation": "聽", "level": 3 }, { "word": "little", "translation": "小的", "level": 3 }, { "word": "living", "translation": "活著的", "level": 3 }, { "word": "local", "translation": "本地的", "level": 3 }, { "word": "lonely", "translation": "寂寞的", "level": 3 }, { "word": "lovely", "translation": "可愛的", "level": 3 }, { "word": "machine", "translation": "機器", "level": 3 }, { "word": "magic", "translation": "魔術", "level": 3 }, { "word": "major", "translation": "主要的", "level": 3 }, { "word": "market", "translation": "市場", "level": 3 }, { "word": "marry", "translation": "結婚", "level": 3 }, { "word": "master", "translation": "大師", "level": 3 }, { "word": "match", "translation": "比賽", "level": 3 }, { "word": "matter", "translation": "事情", "level": 3 }, { "word": "maybe", "translation": "也許", "level": 3 }, { "word": "media", "translation": "媒體", "level": 3 }, { "word": "memory", "translation": "記憶", "level": 3 }, { "word": "metal", "translation": "金屬", "level": 3 }, { "word": "middle", "translation": "中間", "level": 3 }, { "word": "minute", "translation": "分鐘", "level": 3 }, { "word": "model", "translation": "模型", "level": 3 }, { "word": "modern", "translation": "現代的", "level": 3 }, { "word": "moment", "translation": "片刻", "level": 3 }, { "word": "money", "translation": "錢", "level": 3 }, { "word": "month", "translation": "月份", "level": 3 }, { "word": "morning", "translation": "早上", "level": 3 }, { "word": "mother", "translation": "母親", "level": 3 }, { "word": "motor", "translation": "馬達", "level": 3 }, { "word": "movie", "translation": "電影", "level": 3 }, { "word": "music", "translation": "音樂", "level": 3 }, { "word": "nation", "translation": "國家", "level": 3 }, { "word": "nature", "translation": "自然", "level": 3 }, { "word": "never", "translation": "從不", "level": 3 }, { "word": "normal", "translation": "正常的", "level": 3 }, { "word": "notice", "translation": "注意", "level": 3 }, { "word": "novel", "translation": "小說", "level": 3 }, { "word": "number", "translation": "數字", "level": 3 }, { "word": "ocean", "translation": "海洋", "level": 3 }, { "word": "offer", "translation": "提供", "level": 3 }, { "word": "office", "translation": "辦公室", "level": 3 }, { "word": "online", "translation": "線上的", "level": 3 }, { "word": "orange", "translation": "橘色", "level": 3 }, { "word": "order", "translation": "順序；訂購", "level": 3 }, { "word": "other", "translation": "其他的", "level": 3 }, { "word": "outside", "translation": "外面", "level": 3 }, { "word": "owner", "translation": "物主", "level": 3 }, { "word": "paint", "translation": "油漆；畫", "level": 3 }, { "word": "paper", "translation": "紙", "level": 3 }, { "word": "parent", "translation": "父母", "level": 3 }, { "word": "party", "translation": "派對", "level": 3 }, { "word": "people", "translation": "人們", "level": 3 }, { "word": "period", "translation": "期間", "level": 3 }, { "word": "person", "translation": "人", "level": 3 }, { "word": "phone", "translation": "電話", "level": 3 }, { "word": "photo", "translation": "照片", "level": 3 }, { "word": "piano", "translation": "鋼琴", "level": 3 }, { "word": "piece", "translation": "一塊", "level": 3 }, { "word": "place", "translation": "地方", "level": 3 }, { "word": "planet", "translation": "行星", "level": 3 }, { "word": "plant", "translation": "植物", "level": 3 }, { "word": "player", "translation": "玩家", "level": 3 }, { "word": "please", "translation": "請", "level": 3 }, { "word": "police", "translation": "警察", "level": 3 }, { "word": "power", "translation": "力量", "level": 3 }, { "word": "press", "translation": "按", "level": 3 }, { "word": "price", "translation": "價格", "level": 3 }, { "word": "print", "translation": "列印", "level": 3 }, { "word": "prize", "translation": "獎品", "level": 3 }, { "word": "public", "translation": "公開的", "level": 3 }, { "word": "purple", "translation": "紫色", "level": 3 }, { "word": "quality", "translation": "品質", "level": 3 }, { "word": "quarter", "translation": "四分之一", "level": 3 }, { "word": "quiet", "translation": "安靜的", "level": 3 }, { "word": "radio", "translation": "收音機", "level": 3 }, { "word": "raise", "translation": "舉起", "level": 3 }, { "word": "reach", "translation": "到達", "level": 3 }, { "word": "ready", "translation": "準備好的", "level": 3 }, { "word": "reason", "translation": "原因", "level": 3 }, { "word": "record", "translation": "紀錄", "level": 3 }, { "word": "relax", "translation": "放鬆", "level": 3 }, { "word": "remove", "translation": "移除", "level": 3 }, { "word": "repeat", "translation": "重複", "level": 3 }, { "word": "reply", "translation": "回覆", "level": 3 }, { "word": "report", "translation": "報告", "level": 3 }, { "word": "result", "translation": "結果", "level": 3 }, { "word": "return", "translation": "返回", "level": 3 }, { "word": "review", "translation": "評論", "level": 3 }, { "word": "right", "translation": "右邊；正確的", "level": 3 }, { "word": "river", "translation": "河流", "level": 3 }, { "word": "robot", "translation": "機器人", "level": 3 }, { "word": "round", "translation": "圓形的", "level": 3 }, { "word": "ruler", "translation": "尺", "level": 3 }, { "word": "safety", "translation": "安全", "level": 3 }, { "word": "salad", "translation": "沙拉", "level": 3 }, { "word": "school", "translation": "學校", "level": 3 }, { "word": "score", "translation": "分數", "level": 3 }, { "word": "screen", "translation": "螢幕", "level": 3 }, { "word": "search", "translation": "搜尋", "level": 3 }, { "word": "season", "translation": "季節", "level": 3 }, { "word": "second", "translation": "第二", "level": 3 }, { "word": "secret", "translation": "秘密", "level": 3 }, { "word": "select", "translation": "選擇", "level": 3 }, { "word": "senior", "translation": "年長的", "level": 3 }, { "word": "series", "translation": "系列", "level": 3 }, { "word": "service", "translation": "服務", "level": 3 }, { "word": "several", "translation": "幾個", "level": 3 }, { "word": "shake", "translation": "搖動", "level": 3 }, { "word": "shall", "translation": "將會", "level": 3 }, { "word": "shape", "translation": "形狀", "level": 3 }, { "word": "share", "translation": "分享", "level": 3 }, { "word": "sharp", "translation": "鋒利的", "level": 3 }, { "word": "sheet", "translation": "床單；一張", "level": 3 }, { "word": "shine", "translation": "發光", "level": 3 }, { "word": "shoot", "translation": "射擊", "level": 3 }, { "word": "short", "translation": "短的", "level": 3 }, { "word": "should", "translation": "應該", "level": 3 }, { "word": "shout", "translation": "喊叫", "level": 3 }, { "word": "sight", "translation": "視線", "level": 3 }, { "word": "signal", "translation": "信號", "level": 3 }, { "word": "silent", "translation": "安靜的", "level": 3 }, { "word": "silver", "translation": "銀", "level": 3 }, { "word": "simple", "translation": "簡單的", "level": 3 }, { "word": "since", "translation": "自從", "level": 3 }, { "word": "single", "translation": "單一的", "level": 3 }, { "word": "sister", "translation": "姐妹", "level": 3 }, { "word": "skill", "translation": "技巧", "level": 3 }, { "word": "sleep", "translation": "睡覺", "level": 3 }, { "word": "slowly", "translation": "慢慢地", "level": 3 }, { "word": "small", "translation": "小的", "level": 3 }, { "word": "smart", "translation": "聰明的", "level": 3 }, { "word": "smile", "translation": "微笑", "level": 3 }, { "word": "smoke", "translation": "煙", "level": 3 }, { "word": "social", "translation": "社交的", "level": 3 }, { "word": "solve", "translation": "解決", "level": 3 }, { "word": "sorry", "translation": "抱歉的", "level": 3 }, { "word": "sound", "translation": "聲音", "level": 3 }, { "word": "source", "translation": "來源", "level": 3 }, { "word": "space", "translation": "空間", "level": 3 }, { "word": "speak", "translation": "說話", "level": 3 }, { "word": "special", "translation": "特別的", "level": 3 }, { "word": "spend", "translation": "花費", "level": 3 }, { "word": "spirit", "translation": "精神", "level": 3 }, { "word": "sport", "translation": "運動", "level": 3 }, { "word": "spring", "translation": "春天", "level": 3 }, { "word": "square", "translation": "正方形", "level": 3 }, { "word": "stable", "translation": "穩定的", "level": 3 }, { "word": "stage", "translation": "舞台", "level": 3 }, { "word": "stand", "translation": "站立", "level": 3 }, { "word": "start", "translation": "開始", "level": 3 }, { "word": "state", "translation": "狀態", "level": 3 }, { "word": "station", "translation": "車站", "level": 3 }, { "word": "status", "translation": "地位", "level": 3 }, { "word": "steal", "translation": "偷", "level": 3 }, { "word": "steel", "translation": "鋼鐵", "level": 3 }, { "word": "stick", "translation": "棍子；黏貼", "level": 3 }, { "word": "still", "translation": "仍然", "level": 3 }, { "word": "stock", "translation": "庫存", "level": 3 }, { "word": "stomach", "translation": "胃", "level": 3 }, { "word": "stone", "translation": "石頭", "level": 3 }, { "word": "store", "translation": "商店", "level": 3 }, { "word": "storm", "translation": "暴風雨", "level": 3 }, { "word": "story", "translation": "故事", "level": 3 }, { "word": "street", "translation": "街道", "level": 3 }, { "word": "stress", "translation": "壓力", "level": 3 }, { "word": "strike", "translation": "罷工；打擊", "level": 3 }, { "word": "string", "translation": "細繩", "level": 3 }, { "word": "strong", "translation": "強壯的", "level": 3 }, { "word": "student", "translation": "學生", "level": 3 }, { "word": "studio", "translation": "工作室", "level": 3 }, { "word": "study", "translation": "學習", "level": 3 }, { "word": "style", "translation": "風格", "level": 3 }, { "word": "subject", "translation": "主題", "level": 3 }, { "word": "success", "translation": "成功", "level": 3 }, { "word": "suggest", "translation": "建議", "level": 3 }, { "word": "summer", "translation": "夏天", "level": 3 }, { "word": "support", "translation": "支持", "level": 3 }, { "word": "surface", "translation": "表面", "level": 3 }, { "word": "system", "translation": "系統", "level": 3 }, { "word": "table", "translation": "桌子", "level": 3 }, { "word": "talent", "translation": "天賦", "level": 3 }, { "word": "target", "translation": "目標", "level": 3 }, { "word": "taste", "translation": "嚐", "level": 3 }, { "word": "teacher", "translation": "老師", "level": 3 }, { "word": "team", "translation": "隊伍", "level": 3 }, { "word": "thank", "translation": "謝謝", "level": 3 }, { "word": "their", "translation": "他們的", "level": 3 }, { "word": "theme", "translation": "主題", "level": 3 }, { "word": "there", "translation": "那裡", "level": 3 }, { "word": "these", "translation": "這些", "level": 3 }, { "word": "thick", "translation": "厚的", "level": 3 }, { "word": "thing", "translation": "東西", "level": 3 }, { "word": "think", "translation": "想", "level": 3 }, { "word": "third", "translation": "第三", "level": 3 }, { "word": "those", "translation": "那些", "level": 3 }, { "word": "though", "translation": "雖然", "level": 3 }, { "word": "threat", "translation": "威脅", "level": 3 }, { "word": "three", "translation": "三", "level": 3 }, { "word": "throw", "translation": "丟", "level": 3 }, { "word": "ticket", "translation": "票", "level": 3 }, { "word": "tight", "translation": "緊的", "level": 3 }, { "word": "title", "translation": "標題", "level": 3 }, { "word": "today", "translation": "今天", "level": 3 }, { "word": "toilet", "translation": "廁所", "level": 3 }, { "word": "tomato", "translation": "番茄", "level": 3 }, { "word": "tongue", "translation": "舌頭", "level": 3 }, { "word": "tonight", "translation": "今晚", "level": 3 }, { "word": "topic", "translation": "主題", "level": 3 }, { "word": "total", "translation": "總共的", "level": 3 }, { "word": "touch", "translation": "觸摸", "level": 3 }, { "word": "tough", "translation": "困難的", "level": 3 }, { "word": "tour", "translation": "旅行", "level": 3 }, { "word": "toward", "translation": "朝向", "level": 3 }, { "word": "towel", "translation": "毛巾", "level": 3 }, { "word": "tower", "translation": "塔", "level": 3 }, { "word": "trace", "translation": "追蹤", "level": 3 }, { "word": "track", "translation": "軌道", "level": 3 }, { "word": "trade", "translation": "貿易", "level": 3 }, { "word": "traffic", "translation": "交通", "level": 3 }, { "word": "train", "translation": "火車", "level": 3 }, { "word": "travel", "translation": "旅行", "level": 3 }, { "word": "treat", "translation": "對待", "level": 3 }, { "word": "trend", "translation": "趨勢", "level": 3 }, { "word": "trial", "translation": "審判；試驗", "level": 3 }, { "word": "tribe", "translation": "部落", "level": 3 }, { "word": "trick", "translation": "詭計", "level": 3 }, { "word": "troop", "translation": "部隊", "level": 3 }, { "word": "trouble", "translation": "麻煩", "level": 3 }, { "word": "truck", "translation": "卡車", "level": 3 }, { "word": "truly", "translation": "真正地", "level": 3 }, { "word": "trust", "translation": "信任", "level": 3 }, { "word": "truth", "translation": "真相", "level": 3 }, { "word": "twice", "translation": "兩次", "level": 3 }, { "word": "uncle", "translation": "叔叔", "level": 3 }, { "word": "under", "translation": "在...之下", "level": 3 }, { "word": "unique", "translation": "獨特的", "level": 3 }, { "word": "unite", "translation": "團結", "level": 3 }, { "word": "unless", "translation": "除非", "level": 3 }, { "word": "until", "translation": "直到", "level": 3 }, { "word": "upper", "translation": "上面的", "level": 3 }, { "word": "urban", "translation": "都市的", "level": 3 }, { "word": "useful", "translation": "有用的", "level": 3 }, { "word": "usual", "translation": "通常的", "level": 3 }, { "word": "valley", "translation": "山谷", "level": 3 }, { "word": "value", "translation": "價值", "level": 3 }, { "word": "various", "translation": "各式各樣的", "level": 3 }, { "word": "vehicle", "translation": "車輛", "level": 3 }, { "word": "version", "translation": "版本", "level": 3 }, { "word": "very", "translation": "非常", "level": 3 }, { "word": "victim", "translation": "受害者", "level": 3 }, { "word": "victory", "translation": "勝利", "level": 3 }, { "word": "video", "translation": "影片", "level": 3 }, { "word": "village", "translation": "村莊", "level": 3 }, { "word": "violent", "translation": "暴力的", "level": 3 }, { "word": "visit", "translation": "拜訪", "level": 3 }, { "word": "visual", "translation": "視覺的", "level": 3 }, { "word": "voice", "translation": "聲音", "level": 3 }, { "word": "volume", "translation": "音量；體積", "level": 3 }, { "word": "voter", "translation": "投票者", "level": 3 }, { "word": "wagon", "translation": "馬車", "level": 3 }, { "word": "waist", "translation": "腰", "level": 3 }, { "word": "wake", "translation": "醒來", "level": 3 }, { "word": "walk", "translation": "走路", "level": 3 }, { "word": "want", "translation": "想要", "level": 3 }, { "word": "warning", "translation": "警告", "level": 3 }, { "word": "waste", "translation": "浪費", "level": 3 }, { "word": "watch", "translation": "看", "level": 3 }, { "word": "water", "translation": "水", "level": 3 }, { "word": "weapon", "translation": "武器", "level": 3 }, { "word": "wear", "translation": "穿", "level": 3 }, { "word": "weather", "translation": "天氣", "level": 3 }, { "word": "website", "translation": "網站", "level": 3 }, { "word": "wedding", "translation": "婚禮", "level": 3 }, { "word": "weekend", "translation": "週末", "level": 3 }, { "word": "weight", "translation": "重量", "level": 3 }, { "word": "welcome", "translation": "歡迎", "level": 3 }, { "word": "western", "translation": "西方的", "level": 3 }, { "word": "wheel", "translation": "輪子", "level": 3 }, { "word": "where", "translation": "哪裡", "level": 3 }, { "word": "whether", "translation": "是否", "level": 3 }, { "word": "which", "translation": "哪個", "level": 3 }, { "word": "while", "translation": "當...時候", "level": 3 }, { "word": "white", "translation": "白色的", "level": 3 }, { "word": "whole", "translation": "全部的", "level": 3 }, { "word": "whose", "translation": "誰的", "level": 3 }, { "word": "width", "translation": "寬度", "level": 3 }, { "word": "willing", "translation": "願意的", "level": 3 }, { "word": "window", "translation": "窗戶", "level": 3 }, { "word": "winter", "translation": "冬天", "level": 3 }, { "word": "within", "translation": "在...之內", "level": 3 }, { "word": "without", "translation": "沒有", "level": 3 }, { "word": "woman", "translation": "女人", "level": 3 }, { "word": "wonder", "translation": "想知道", "level": 3 }, { "word": "wooden", "translation": "木製的", "level": 3 }, { "word": "worker", "translation": "工人", "level": 3 }, { "word": "world", "translation": "世界", "level": 3 }, { "word": "worry", "translation": "擔心", "level": 3 }, { "word": "worth", "translation": "值得", "level": 3 }, { "word": "wound", "translation": "傷口", "level": 3 }, { "word": "writer", "translation": "作家", "level": 3 }, { "word": "wrong", "translation": "錯誤的", "level": 3 }, { "word": "yellow", "translation": "黃色的", "level": 3 }, { "word": "younger", "translation": "較年輕的", "level": 3 }, { "word": "youth", "translation": "年輕", "level": 3 },
          { "word": "ability", "translation": "能力", "level": 4 }, { "word": "abroad", "translation": "在國外", "level": 4 }, { "word": "accept", "translation": "接受", "level": 4 }, { "word": "access", "translation": "接近；使用權", "level": 4 }, { "word": "across", "translation": "穿過", "level": 4 }, { "word": "action", "translation": "行動", "level": 4 }, { "word": "active", "translation": "活躍的", "level": 4 }, { "word": "activity", "translation": "活動", "level": 4 }, { "word": "actual", "translation": "實際的", "level": 4 }, { "word": "address", "translation": "地址", "level": 4 }, { "word": "admire", "translation": "欽佩", "level": 4 }, { "word": "advance", "translation": "前進", "level": 4 }, { "word": "advice", "translation": "建議", "level": 4 }, { "word": "affair", "translation": "事件", "level": 4 }, { "word": "against", "translation": "反對", "level": 4 }, { "word": "agency", "translation": "代理機構", "level": 4 }, { "word": "although", "translation": "雖然", "level": 4 }, { "word": "ancient", "translation": "古老的", "level": 4 }, { "word": "another", "translation": "另一個", "level": 4 }, { "word": "answer", "translation": "答案", "level": 4 }, { "word": "anxious", "translation": "焦慮的", "level": 4 }, { "word": "anyone", "translation": "任何人", "level": 4 }, { "word": "anyway", "translation": "無論如何", "level": 4 }, { "word": "appear", "translation": "出現", "level": 4 }, { "word": "approach", "translation": "接近", "level": 4 }, { "word": "approve", "translation": "批准", "level": 4 }, { "word": "around", "translation": "在...周圍", "level": 4 }, { "word": "arrange", "translation": "安排", "level": 4 }, { "word": "article", "translation": "文章", "level": 4 }, { "word": "artist", "translation": "藝術家", "level": 4 }, { "word": "asleep", "translation": "睡著的", "level": 4 }, { "word": "assist", "translation": "協助", "level": 4 }, { "word": "assume", "translation": "假設", "level": 4 }, { "word": "attack", "translation": "攻擊", "level": 4 }, { "word": "attend", "translation": "出席", "level": 4 }, { "word": "attitude", "translation": "態度", "level": 4 }, { "word": "attract", "translation": "吸引", "level": 4 }, { "word": "audience", "translation": "觀眾", "level": 4 }, { "word": "author", "translation": "作者", "level": 4 }, { "word": "average", "translation": "平均的", "level": 4 }, { "word": "avoid", "translation": "避免", "level": 4 }, { "word": "balance", "translation": "平衡", "level": 4 }, { "word": "bargain", "translation": "討價還價", "level": 4 }, { "word": "battle", "translation": "戰鬥", "level": 4 }, { "word": "beautiful", "translation": "美麗的", "level": 4 }, { "word": "because", "translation": "因為", "level": 4 }, { "word": "become", "translation": "變成", "level": 4 }, { "word": "before", "translation": "在...之前", "level": 4 }, { "word": "behave", "translation": "行為", "level": 4 }, { "word": "behind", "translation": "在...後面", "level": 4 }, { "word": "believe", "translation": "相信", "level": 4 }, { "word": "belong", "translation": "屬於", "level": 4 }, { "word": "benefit", "translation": "好處", "level": 4 }, { "word": "between", "translation": "在...之間", "level": 4 }, { "word": "bicycle", "translation": "自行車", "level": 4 }, { "word": "biology", "translation": "生物學", "level": 4 }, { "word": "border", "translation": "邊界", "level": 4 }, { "word": "borrow", "translation": "借", "level": 4 }, { "word": "bother", "translation": "打擾", "level": 4 }, { "word": "bottom", "translation": "底部", "level": 4 }, { "word": "brain", "translation": "大腦", "level": 4 }, { "word": "branch", "translation": "樹枝；分公司", "level": 4 }, { "word": "brave", "translation": "勇敢的", "level": 4 }, { "word": "breakfast", "translation": "早餐", "level": 4 }, { "word": "breathe", "translation": "呼吸", "level": 4 }, { "word": "bridge", "translation": "橋", "level": 4 }, { "word": "bright", "translation": "明亮的", "level": 4 }, { "word": "brother", "translation": "兄弟", "level": 4 }, { "word": "budget", "translation": "預算", "level": 4 }, { "word": "building", "translation": "建築物", "level": 4 }, { "word": "business", "translation": "生意", "level": 4 }, { "word": "butterfly", "translation": "蝴蝶", "level": 4 }, { "word": "button", "translation": "按鈕", "level": 4 }, { "word": "camera", "translation": "相機", "level": 4 }, { "word": "campaign", "translation": "活動", "level": 4 }, { "word": "cancel", "translation": "取消", "level": 4 }, { "word": "cancer", "translation": "癌症", "level": 4 }, { "word": "candidate", "translation": "候選人", "level": 4 }, { "word": "captain", "translation": "隊長；船長", "level": 4 }, { "word": "careful", "translation": "小心的", "level": 4 }, { "word": "carry", "translation": "攜帶", "level": 4 }, { "word": "celebrate", "translation": "慶祝", "level": 4 }, { "word": "center", "translation": "中心", "level": 4 }, { "word": "central", "translation": "中央的", "level": 4 }, { "word": "century", "translation": "世紀", "level": 4 }, { "word": "certain", "translation": "確定的", "level": 4 }, { "word": "chairman", "translation": "主席", "level": 4 }, { "word": "challenge", "translation": "挑戰", "level": 4 }, { "word": "chance", "translation": "機會", "level": 4 }, { "word": "change", "translation": "改變", "level": 4 }, { "word": "chapter", "translation": "章節", "level": 4 }, { "word": "character", "translation": "角色；性格", "level": 4 }, { "word": "charge", "translation": "收費；充電", "level": 4 }, { "word": "charming", "translation": "迷人的", "level": 4 }, { "word": "cheap", "translation": "便宜的", "level": 4 }, { "word": "cheat", "translation": "作弊", "level": 4 }, { "word": "check", "translation": "檢查", "level": 4 }, { "word": "chemical", "translation": "化學的", "level": 4 }, { "word": "choice", "translation": "選擇", "level": 4 }, { "word": "choose", "translation": "選擇", "level": 4 }, { "word": "citizen", "translation": "公民", "level": 4 }, { "word": "classic", "translation": "經典的", "level": 4 }, { "word": "climate", "translation": "氣候", "level": 4 }, { "word": "closely", "translation": "緊密地", "level": 4 }, { "word": "clothes", "translation": "衣服", "level": 4 }, { "word": "cloudy", "translation": "多雲的", "level": 4 }, { "word": "collect", "translation": "收集", "level": 4 }, { "word": "college", "translation": "大學", "level": 4 }, { "word": "combine", "translation": "結合", "level": 4 }, { "word": "command", "translation": "命令", "level": 4 }, { "word": "comment", "translation": "評論", "level": 4 }, { "word": "common", "translation": "共同的", "level": 4 }, { "word": "compete", "translation": "競爭", "level": 4 }, { "word": "complain", "translation": "抱怨", "level": 4 }, { "word": "complete", "translation": "完成", "level": 4 }, { "word": "complex", "translation": "複雜的", "level": 4 }, { "word": "computer", "translation": "電腦", "level": 4 }, { "word": "concern", "translation": "關心", "level": 4 }, { "word": "concert", "translation": "音樂會", "level": 4 }, { "word": "conclude", "translation": "總結", "level": 4 }, { "word": "condition", "translation": "狀況", "level": 4 }, { "word": "conduct", "translation": "進行", "level": 4 }, { "word": "confirm", "translation": "確認", "level": 4 }, { "word": "conflict", "translation": "衝突", "level": 4 }, { "word": "confuse", "translation": "使困惑", "level": 4 }, { "word": "connect", "translation": "連接", "level": 4 }, { "word": "consider", "translation": "考慮", "level": 4 }, { "word": "consist", "translation": "組成", "level": 4 }, { "word": "contact", "translation": "聯繫", "level": 4 }, { "word": "contain", "translation": "包含", "level": 4 }, { "word": "content", "translation": "內容", "level": 4 }, { "word": "contest", "translation": "比賽", "level": 4 }, { "word": "continue", "translation": "繼續", "level": 4 }, { "word": "contract", "translation": "合約", "level": 4 }, { "word": "control", "translation": "控制", "level": 4 }, { "word": "corner", "translation": "角落", "level": 4 }, { "word": "correct", "translation": "正確的", "level": 4 }, { "word": "costume", "translation": "服裝", "level": 4 }, { "word": "cotton", "translation": "棉花", "level": 4 }, { "word": "could", "translation": "能夠(can過去式)", "level": 4 }, { "word": "council", "translation": "議會", "level": 4 }, { "word": "country", "translation": "國家", "level": 4 }, { "word": "couple", "translation": "一對", "level": 4 }, { "word": "courage", "translation": "勇氣", "level": 4 }, { "word": "course", "translation": "課程", "level": 4 }, { "word": "court", "translation": "法院", "level": 4 }, { "word": "cousin", "translation": "表兄弟姐妹", "level": 4 }, { "word": "create", "translation": "創造", "level": 4 }, { "word": "creative", "translation": "有創意的", "level": 4 }, { "word": "creature", "translation": "生物", "level": 4 }, { "word": "credit", "translation": "信用", "level": 4 }, { "word": "crime", "translation": "犯罪", "level": 4 }, { "word": "crisis", "translation": "危機", "level": 4 }, { "word": "critic", "translation": "評論家", "level": 4 }, { "word": "culture", "translation": "文化", "level": 4 }, { "word": "curious", "translation": "好奇的", "level": 4 }, { "word": "current", "translation": "當前的", "level": 4 }, { "word": "custom", "translation": "習俗", "level": 4 }, { "word": "customer", "translation": "顧客", "level": 4 }, { "word": "damage", "translation": "損害", "level": 4 }, { "word": "danger", "translation": "危險", "level": 4 }, { "word": "daughter", "translation": "女兒", "level": 4 }, { "word": "decide", "translation": "決定", "level": 4 }, { "word": "decision", "translation": "決定", "level": 4 }, { "word": "declare", "translation": "宣布", "level": 4 }, { "word": "decrease", "translation": "減少", "level": 4 }, { "word": "deeply", "translation": "深深地", "level": 4 }, { "word": "defeat", "translation": "擊敗", "level": 4 }, { "word": "defend", "translation": "防禦", "level": 4 }, { "word": "define", "translation": "定義", "level": 4 }, { "word": "degree", "translation": "度數；學位", "level": 4 }, { "word": "delay", "translation": "延遲", "level": 4 }, { "word": "deliver", "translation": "遞送", "level": 4 }, { "word": "demand", "translation": "要求", "level": 4 }, { "word": "deny", "translation": "否認", "level": 4 }, { "word": "depend", "translation": "依賴", "level": 4 }, { "word": "describe", "translation": "描述", "level": 4 }, { "word": "design", "translation": "設計", "level": 4 }, { "word": "desire", "translation": "慾望", "level": 4 }, { "word": "destroy", "translation": "摧毀", "level": 4 }, { "word": "detail", "translation": "細節", "level": 4 }, { "word": "detect", "translation": "偵測", "level": 4 }, { "word": "develop", "translation": "發展", "level": 4 }, { "word": "device", "translation": "裝置", "level": 4 }, { "word": "different", "translation": "不同的", "level": 4 }, { "word": "difficult", "translation": "困難的", "level": 4 }, { "word": "direct", "translation": "直接的", "level": 4 }, { "word": "discover", "translation": "發現", "level": 4 }, { "word": "discuss", "translation": "討論", "level": 4 }, { "word": "disease", "translation": "疾病", "level": 4 }, { "word": "dismiss", "translation": "解散；開除", "level": 4 }, { "word": "display", "translation": "展示", "level": 4 }, { "word": "distance", "translation": "距離", "level": 4 }, { "word": "district", "translation": "地區", "level": 4 }, { "word": "divide", "translation": "劃分", "level": 4 }, { "word": "divorce", "translation": "離婚", "level": 4 }, { "word": "doctor", "translation": "醫生", "level": 4 }, { "word": "document", "translation": "文件", "level": 4 }, { "word": "double", "translation": "雙倍的", "level": 4 }, { "word": "download", "translation": "下載", "level": 4 }, { "word": "downtown", "translation": "市中心", "level": 4 }, { "word": "dramatic", "translation": "戲劇性的", "level": 4 }, { "word": "drawing", "translation": "繪畫", "level": 4 }, { "word": "driver", "translation": "司機", "level": 4 }, { "word": "during", "translation": "在...期間", "level": 4 }, { "word": "eastern", "translation": "東方的", "level": 4 }, { "word": "economic", "translation": "經濟的", "level": 4 }, { "word": "economy", "translation": "經濟", "level": 4 }, { "word": "education", "translation": "教育", "level": 4 }, { "word": "effect", "translation": "效果", "level": 4 }, { "word": "effort", "translation": "努力", "level": 4 }, { "word": "either", "translation": "兩者之一", "level": 4 }, { "word": "elect", "translation": "選舉", "level": 4 }, { "word": "election", "translation": "選舉", "level": 4 }, { "word": "electric", "translation": "電的", "level": 4 }, { "word": "element", "translation": "元素", "level": 4 }, { "word": "emotion", "translation": "情緒", "level": 4 }, { "word": "employ", "translation": "僱用", "level": 4 }, { "word": "employee", "translation": "員工", "level": 4 }, { "word": "encourage", "translation": "鼓勵", "level": 4 }, { "word": "energy", "translation": "能量", "level": 4 }, { "word": "engine", "translation": "引擎", "level": 4 }, { "word": "engineer", "translation": "工程師", "level": 4 }, { "word": "enough", "translation": "足夠的", "level": 4 }, { "word": "ensure", "translation": "確保", "level": 4 }, { "word": "enter", "translation": "進入", "level": 4 }, { "word": "entire", "translation": "整個的", "level": 4 }, { "word": "entrance", "translation": "入口", "level": 4 }, { "word": "equal", "translation": "平等的", "level": 4 }, { "word": "equipment", "translation": "設備", "level": 4 }, { "word": "escape", "translation": "逃脫", "level": 4 }, { "word": "evening", "translation": "傍晚", "level": 4 }, { "word": "event", "translation": "事件", "level": 4 }, { "word": "every", "translation": "每個", "level": 4 }, { "word": "evidence", "translation": "證據", "level": 4 }, { "word": "exactly", "translation": "確切地", "level": 4 }, { "word": "examine", "translation": "檢查", "level": 4 }, { "word": "example", "translation": "例子", "level": 4 }, { "word": "excellent", "translation": "優秀的", "level": 4 }, { "word": "except", "translation": "除了", "level": 4 }, { "word": "exchange", "translation": "交換", "level": 4 }, { "word": "excite", "translation": "使興奮", "level": 4 }, { "word": "excuse", "translation": "藉口", "level": 4 }, { "word": "exercise", "translation": "運動", "level": 4 }, { "word": "exhibit", "translation": "展覽", "level": 4 }, { "word": "exist", "translation": "存在", "level": 4 }, { "word": "expand", "translation": "擴展", "level": 4 }, { "word": "expect", "translation": "期望", "level": 4 }, { "word": "expensive", "translation": "昂貴的", "level": 4 }, { "word": "expert", "translation": "專家", "level": 4 }, { "word": "explain", "translation": "解釋", "level": 4 }, { "word": "explore", "translation": "探索", "level": 4 }, { "word": "export", "translation": "出口", "level": 4 }, { "word": "express", "translation": "表達", "level": 4 }, { "word": "extend", "translation": "延伸", "level": 4 }, { "word": "external", "translation": "外部的", "level": 4 }, { "word": "extra", "translation": "額外的", "level": 4 }, { "word": "extreme", "translation": "極端的", "level": 4 }, { "word": "factory", "translation": "工廠", "level": 4 }, { "word": "failure", "translation": "失敗", "level": 4 }, { "word": "familiar", "translation": "熟悉的", "level": 4 }, { "word": "family", "translation": "家庭", "level": 4 }, { "word": "famous", "translation": "著名的", "level": 4 }, { "word": "fashion", "translation": "時尚", "level": 4 }, { "word": "father", "translation": "父親", "level": 4 }, { "word": "favorite", "translation": "最喜歡的", "level": 4 }, { "word": "feature", "translation": "特徵", "level": 4 }, { "word": "federal", "translation": "聯邦的", "level": 4 }, { "word": "feeling", "translation": "感覺", "level": 4 }, { "word": "female", "translation": "女性的", "level": 4 }, { "word": "festival", "translation": "節日", "level": 4 }, { "word": "fiction", "translation": "小說", "level": 4 }, { "word": "field", "translation": "領域；田地", "level": 4 }, { "word": "figure", "translation": "數字；人物", "level": 4 }, { "word": "final", "translation": "最終的", "level": 4 }, { "word": "finance", "translation": "金融", "level": 4 }, { "word": "financial", "translation": "金融的", "level": 4 }, { "word": "finger", "translation": "手指", "level": 4 }, { "word": "finish", "translation": "完成", "level": 4 }, { "word": "flower", "translation": "花", "level": 4 }, { "word": "focus", "translation": "專注", "level": 4 }, { "word": "follow", "translation": "跟隨", "level": 4 }, { "word": "foreign", "translation": "外國的", "level": 4 }, { "word": "forest", "translation": "森林", "level": 4 }, { "word": "forget", "translation": "忘記", "level": 4 }, { "word": "formal", "translation": "正式的", "level": 4 }, { "word": "format", "translation": "格式", "level": 4 }, { "word": "former", "translation": "從前的", "level": 4 }, { "word": "forward", "translation": "向前", "level": 4 }, { "word": "found", "translation": "建立", "level": 4 }, { "word": "founder", "translation": "創辦人", "level": 4 }, { "word": "freedom", "translation": "自由", "level": 4 }, { "word": "frequent", "translation": "頻繁的", "level": 4 }, { "word": "freshman", "translation": "新生", "level": 4 }, { "word": "friend", "translation": "朋友", "level": 4 }, { "word": "friendly", "translation": "友善的", "level": 4 }, { "word": "frighten", "translation": "使害怕", "level": 4 }, { "word": "furniture", "translation": "傢俱", "level": 4 }, { "word": "future", "translation": "未來", "level": 4 }, { "word": "garbage", "translation": "垃圾", "level": 4 }, { "word": "garden", "translation": "花園", "level": 4 }, { "word": "gather", "translation": "聚集", "level": 4 }, { "word": "general", "translation": "一般的", "level": 4 }, { "word": "generate", "translation": "產生", "level": 4 }, { "word": "generous", "translation": "慷慨的", "level": 4 }, { "word": "gentle", "translation": "溫柔的", "level": 4 }, { "word": "gentleman", "translation": "紳士", "level": 4 }, { "word": "geography", "translation": "地理", "level": 4 }, { "word": "global", "translation": "全球的", "level": 4 }, { "word": "grade", "translation": "年級；成績", "level": 4 }, { "word": "graduate", "translation": "畢業", "level": 4 }, { "word": "grammar", "translation": "文法", "level": 4 }, { "word": "grand", "translation": "宏偉的", "level": 4 }, { "word": "grass", "translation": "草", "level": 4 }, { "word": "grateful", "translation": "感激的", "level": 4 }, { "word": "greatly", "translation": "大大地", "level": 4 }, { "word": "green", "translation": "綠色", "level": 4 }, { "word": "grocery", "translation": "雜貨", "level": 4 }, { "word": "ground", "translation": "地面", "level": 4 }, { "word": "group", "translation": "團體", "level": 4 }, { "word": "growth", "translation": "成長", "level": 4 }, { "word": "guarantee", "translation": "保證", "level": 4 }, { "word": "guard", "translation": "守衛", "level": 4 }, { "word": "guess", "translation": "猜測", "level": 4 }, { "word": "guest", "translation": "客人", "level": 4 }, { "word": "guide", "translation": "引導", "level": 4 }, { "word": "guilty", "translation": "有罪的", "level": 4 }, { "word": "habit", "translation": "習慣", "level": 4 }, { "word": "handsome", "translation": "英俊的", "level": 4 }, { "word": "happen", "translation": "發生", "level": 4 }, { "word": "hardly", "translation": "幾乎不", "level": 4 }, { "word": "health", "translation": "健康", "level": 4 }, { "word": "healthy", "translation": "健康的", "level": 4 }, { "word": "hearing", "translation": "聽力", "level": 4 }, { "word": "heavily", "translation": "沉重地", "level": 4 }, { "word": "height", "translation": "高度", "level": 4 }, { "word": "helpful", "translation": "有幫助的", "level": 4 }, { "word": "herself", "translation": "她自己", "level": 4 }, { "word": "hesitate", "translation": "猶豫", "level": 4 }, { "word": "history", "translation": "歷史", "level": 4 }, { "word": "holiday", "translation": "假日", "level": 4 }, { "word": "honest", "translation": "誠實的", "level": 4 }, { "word": "honor", "translation": "榮譽", "level": 4 }, { "word": "horrible", "translation": "可怕的", "level": 4 }, { "word": "hospital", "translation": "醫院", "level": 4 }, { "word": "however", "translation": "然而", "level": 4 }, { "word": "human", "translation": "人類", "level": 4 }, { "word": "humor", "translation": "幽默", "level": 4 }, { "word": "humorous", "translation": "幽默的", "level": 4 }, { "word": "hundred", "translation": "一百", "level": 4 }, { "word": "hunger", "translation": "飢餓", "level": 4 }, { "word": "hungry", "translation": "飢餓的", "level": 4 }, { "word": "hunter", "translation": "獵人", "level": 4 }, { "word": "hurry", "translation": "匆忙", "level": 4 }, { "word": "husband", "translation": "丈夫", "level": 4 }, { "word": "ignore", "translation": "忽略", "level": 4 }, { "word": "imagine", "translation": "想像", "level": 4 }, { "word": "immediate", "translation": "立即的", "level": 4 }, { "word": "impact", "translation": "影響", "level": 4 }, { "word": "import", "translation": "進口", "level": 4 }, { "word": "important", "translation": "重要的", "level": 4 }, { "word": "impossible", "translation": "不可能的", "level": 4 }, { "word": "impress", "translation": "使印象深刻", "level": 4 }, { "word": "improve", "translation": "改善", "level": 4 }, { "word": "include", "translation": "包含", "level": 4 }, { "word": "income", "translation": "收入", "level": 4 }, { "word": "increase", "translation": "增加", "level": 4 }, { "word": "indeed", "translation": "確實", "level": 4 }, { "word": "indicate", "translation": "指出", "level": 4 }, { "word": "industry", "translation": "工業", "level": 4 }, { "word": "influence", "translation": "影響", "level": 4 }, { "word": "inform", "translation": "通知", "level": 4 }, { "word": "initial", "translation": "最初的", "level": 4 }, { "word": "injure", "translation": "傷害", "level": 4 }, { "word": "injury", "translation": "傷害", "level": 4 }, { "word": "inner", "translation": "內部的", "level": 4 }, { "word": "innocent", "translation": "無辜的", "level": 4 }, { "word": "inside", "translation": "在...裡面", "level": 4 }, { "word": "insist", "translation": "堅持", "level": 4 }, { "word": "install", "translation": "安裝", "level": 4 }, { "word": "instance", "translation": "例子", "level": 4 }, { "word": "instead", "translation": "代替", "level": 4 }, { "word": "interest", "translation": "興趣", "level": 4 }, { "word": "internal", "translation": "內部的", "level": 4 }, { "word": "internet", "translation": "網路", "level": 4 }, { "word": "interview", "translation": "面試", "level": 4 }, { "word": "introduce", "translation": "介紹", "level": 4 }, { "word": "invent", "translation": "發明", "level": 4 }, { "word": "invest", "translation": "投資", "level": 4 }, { "word": "invite", "translation": "邀請", "level": 4 }, { "word": "involve", "translation": "涉及", "level": 4 }, { "word": "island", "translation": "島嶼", "level": 4 }, { "word": "issue", "translation": "議題", "level": 4 }, { "word": "itself", "translation": "它自己", "level": 4 }, { "word": "jacket", "translation": "夾克", "level": 4 }, { "word": "jealous", "translation": "嫉妒的", "level": 4 }, { "word": "journey", "translation": "旅程", "level": 4 }, { "word": "judgment", "translation": "判斷", "level": 4 }, { "word": "junior", "translation": "年少的", "level": 4 }, { "word": "justice", "translation": "正義", "level": 4 }, { "word": "keeper", "translation": "看守人", "level": 4 }, { "word": "keyboard", "translation": "鍵盤", "level": 4 }, { "word": "kitchen", "translation": "廚房", "level": 4 }, { "word": "knowledge", "translation": "知識", "level": 4 }, { "word": "labor", "translation": "勞動", "level": 4 }, { "word": "language", "translation": "語言", "level": 4 }, { "word": "largely", "translation": "主要地", "level": 4 }, { "word": "lately", "translation": "最近", "level": 4 }, { "word": "latter", "translation": "後者", "level": 4 }, { "word": "laugh", "translation": "笑", "level": 4 }, { "word": "launch", "translation": "發射", "level": 4 }, { "word": "lawyer", "translation": "律師", "level": 4 }, { "word": "leader", "translation": "領導者", "level": 4 }, { "word": "leading", "translation": "領導的", "level": 4 }, { "word": "league", "translation": "聯盟", "level": 4 }, { "word": "leather", "translation": "皮革", "level": 4 }, { "word": "lecture", "translation": "演講", "level": 4 }, { "word": "legal", "translation": "法律的", "level": 4 }, { "word": "leisure", "translation": "休閒", "level": 4 }, { "word": "length", "translation": "長度", "level": 4 }, { "word": "lesson", "translation": "課程", "level": 4 }, { "word": "level", "translation": "水平；等級", "level": 4 }, { "word": "liberal", "translation": "自由的", "level": 4 }, { "word": "library", "translation": "圖書館", "level": 4 }, { "word": "license", "translation": "執照", "level": 4 }, { "word": "lifestyle", "translation": "生活方式", "level": 4 }, { "word": "likely", "translation": "可能的", "level": 4 }, { "word": "limit", "translation": "限制", "level": 4 }, { "word": "limited", "translation": "有限的", "level": 4 }, { "word": "literary", "translation": "文學的", "level": 4 }, { "word": "location", "translation": "位置", "level": 4 }, { "word": "magazine", "translation": "雜誌", "level": 4 }, { "word": "maintain", "translation": "維持", "level": 4 }, { "word": "majority", "translation": "大多數", "level": 4 }, { "word": "manage", "translation": "管理", "level": 4 }, { "word": "manager", "translation": "經理", "level": 4 }, { "word": "marketing", "translation": "行銷", "level": 4 }, { "word": "marriage", "translation": "婚姻", "level": 4 }, { "word": "material", "translation": "材料", "level": 4 }, { "word": "maximum", "translation": "最大值", "level": 4 }, { "word": "measure", "translation": "測量", "level": 4 }, { "word": "medical", "translation": "醫療的", "level": 4 }, { "word": "medicine", "translation": "藥", "level": 4 }, { "word": "medium", "translation": "中間的", "level": 4 }, { "word": "member", "translation": "成員", "level": 4 }, { "word": "mental", "translation": "精神的", "level": 4 }, { "word": "mention", "translation": "提及", "level": 4 }, { "word": "message", "translation": "訊息", "level": 4 }, { "word": "military", "translation": "軍事的", "level": 4 }, { "word": "million", "translation": "百萬", "level": 4 }, { "word": "minister", "translation": "部長", "level": 4 }, { "word": "minor", "translation": "次要的", "level": 4 }, { "word": "minority", "translation": "少數", "level": 4 }, { "word": "mirror", "translation": "鏡子", "level": 4 }, { "word": "mission", "translation": "任務", "level": 4 }, { "word": "mistake", "translation": "錯誤", "level": 4 }, { "word": "monitor", "translation": "監視器", "level": 4 }, { "word": "monthly", "translation": "每月的", "level": 4 }, { "word": "moral", "translation": "道德的", "level": 4 }, { "word": "motion", "translation": "動作", "level": 4 }, { "word": "mountain", "translation": "山", "level": 4 }, { "word": "mouse", "translation": "老鼠；滑鼠", "level": 4 }, { "word": "movement", "translation": "運動；移動", "level": 4 }, { "word": "multiple", "translation": "多個的", "level": 4 }, { "word": "murder", "translation": "謀殺", "level": 4 }, { "word": "museum", "translation": "博物館", "level": 4 }, { "word": "musical", "translation": "音樂的", "level": 4 }, { "word": "musician", "translation": "音樂家", "level": 4 }, { "word": "mystery", "translation": "謎", "level": 4 }
        ];

        // ==================================================================
        
        let completedWordsThisGame = [];

        function resizeCanvas() {
            canvas.width = gameContainer.clientWidth;
            canvas.height = gameContainer.clientHeight;
        }

        class Player {
            constructor() {
                this.width = 22;
                this.height = 22;
                this.x = canvas.width / 2;
                this.y = canvas.height - this.height - 20;
                this.health = 5;
                this.maxHealth = 5;
                this.hasShield = false;
            }

            draw() {
                if (this.hasShield) {
                    ctx.save();
                    ctx.beginPath();
                    ctx.arc(this.x, this.y + this.height / 2, this.width * 0.8, 0, Math.PI * 2);
                    ctx.strokeStyle = `rgba(0, 255, 255, ${0.5 + Math.random() * 0.3})`;
                    ctx.lineWidth = 3;
                    ctx.stroke();
                    ctx.restore();
                }

                ctx.fillStyle = `rgba(255, 165, 0, ${Math.random() * 0.5 + 0.5})`;
                ctx.beginPath();
                ctx.moveTo(this.x - 3, this.y + this.height - 4);
                ctx.lineTo(this.x + 3, this.y + this.height - 4);
                ctx.lineTo(this.x, this.y + this.height + Math.random() * 8);
                ctx.closePath();
                ctx.fill();

                ctx.fillStyle = '#00ffff';
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(this.x + 11, this.y + 18);
                ctx.lineTo(this.x + 6.5, this.y + 15.5);
                ctx.lineTo(this.x, this.y + 22);
                ctx.lineTo(this.x - 6.5, this.y + 15.5);
                ctx.lineTo(this.x - 11, this.y + 18);
                ctx.closePath();
                ctx.fill();
                
                ctx.fillStyle = '#1a1a1a';
                ctx.beginPath();
                ctx.moveTo(this.x, this.y + 6.5);
                ctx.lineTo(this.x + 2, this.y + 11);
                ctx.lineTo(this.x - 2, this.y + 11);
                ctx.closePath();
                ctx.fill();
            }
            
            loseHealth() {
                if (this.hasShield) {
                    this.hasShield = false;
                    createExplosion(this.x, this.y, '#00ffff');
                    return;
                }
                this.health--;
                updateHealthUI();
                createExplosion(this.x, this.y, '#ff4500');
                if (this.health <= 0) {
                    gameOver();
                }
            }
        }

        class Enemy {
            constructor(x, y, wordData) {
                this.x = x;
                this.y = y;
                this.width = 28;
                this.height = 28;
                this.wordData = wordData;
                this.word = wordData.word;
                
                // --- DIFFICULTY CHANGE: Slower speed scaling from wave 3 ---
                let speedMultiplier = 0.5;
                if (wave >= 3) {
                    speedMultiplier = 0.4; // 從第3波開始，速度增長減緩
                }
                this.speed = (0.5 + (wave * 0.1)) * speedMultiplier; 
                
                this.typedIndex = 0;
                this.isTargeted = false;
                this.color = '#ffd700';
                this.shapeType = Math.floor(Math.random() * 3);
                this.vx = (Math.random() - 0.5) * 1.5;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                switch(this.shapeType) {
                    case 0:
                        ctx.moveTo(this.x, this.y + this.height);
                        ctx.lineTo(this.x + this.width / 2, this.y);
                        ctx.lineTo(this.x - this.width / 2, this.y);
                        break;
                    case 1:
                        ctx.moveTo(this.x, this.y + this.height);
                        ctx.lineTo(this.x + this.width / 2, this.y + this.height/2);
                        ctx.lineTo(this.x, this.y);
                        ctx.lineTo(this.x - this.width / 2, this.y + this.height/2);
                        break;
                    case 2:
                        ctx.moveTo(this.x, this.y + this.height * 0.7);
                        ctx.lineTo(this.x + this.width / 2, this.y);
                        ctx.lineTo(this.x, this.y + this.height);
                        ctx.lineTo(this.x - this.width / 2, this.y);
                        break;
                }
                ctx.closePath();
                ctx.fill();

                ctx.font = "bold 12px 'Press Start 2P'";
                ctx.textAlign = 'center';
                const yOffset = this.y - 10;
                const textWidth = ctx.measureText(this.word).width;
                
                ctx.fillStyle = 'rgba(0, 0, 0, 0.6)';
                ctx.fillRect(this.x - textWidth / 2 - 4, yOffset - 12, textWidth + 8, 18);

                if (this.isTargeted) {
                    const typedPart = this.word.substring(0, this.typedIndex);
                    const untypedPart = this.word.substring(this.typedIndex);
                    const typedWidth = ctx.measureText(typedPart).width;
                    const startX = this.x - textWidth / 2;
                    
                    ctx.fillStyle = '#00ff00';
                    ctx.fillText(typedPart, startX + typedWidth / 2, yOffset);
                    ctx.fillStyle = '#ff4500';
                    ctx.fillText(untypedPart, startX + typedWidth + ctx.measureText(untypedPart).width / 2, yOffset);
                } else {
                    ctx.fillStyle = '#ffffff';
                    ctx.fillText(this.word, this.x, yOffset);
                }
            }

            update() {
                if (this.y < canvas.height / 2) {
                    this.y += this.speed;
                    this.x += this.vx;
                    if (this.x - this.width/2 < 0 || this.x + this.width/2 > canvas.width) {
                        this.vx *= -1;
                    }
                } else {
                    const angle = Math.atan2(player.y - this.y, player.x - this.x);
                    this.x += Math.cos(angle) * this.speed;
                    this.y += Math.sin(angle) * this.speed;
                }
            }
        }

        class Bullet {
            constructor(x, y, target) {
                this.x = x;
                this.y = y;
                this.target = target;
                this.radius = 3;
                this.color = '#00ff00';
                this.speed = 8;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
            }

            update() {
                const angle = Math.atan2(this.target.y - this.y, this.target.x - this.x);
                this.x += Math.cos(angle) * this.speed;
                this.y += Math.sin(angle) * this.speed;
            }
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.radius = Math.random() * 2 + 1;
                this.velocity = { x: (Math.random() - 0.5) * 6, y: (Math.random() - 0.5) * 6 };
                this.alpha = 1;
                this.friction = 0.98;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }

            update() {
                this.velocity.x *= this.friction;
                this.velocity.y *= this.friction;
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                this.alpha -= 0.02;
            }
        }

        class Drone {
            constructor(player) {
                this.player = player;
                this.radius = 6;
                this.angle = Math.random() * Math.PI * 2;
                this.orbitRadius = 30;
                this.attackCooldown = 5000;
                this.lastAttackTime = Date.now();
            }

            update() {
                this.angle += 0.03;
                this.x = this.player.x + Math.cos(this.angle) * this.orbitRadius;
                this.y = this.player.y + this.player.height / 2 + Math.sin(this.angle * 2) * 5;

                const now = Date.now();
                if (now - this.lastAttackTime > this.attackCooldown && enemies.length > 1) {
                    this.fire();
                    this.lastAttackTime = now;
                }
            }

            draw() {
                ctx.fillStyle = '#ff4500';
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
            }

            fire() {
                const validTargets = enemies.filter(enemy => enemy !== currentTarget);
                if (validTargets.length > 0) {
                    const target = validTargets[Math.floor(Math.random() * validTargets.length)];
                    droneLasers.push(new DroneLaser(this.x, this.y, target));
                }
            }
        }

        class DroneLaser {
            constructor(x, y, target) {
                this.x = x;
                this.y = y;
                this.target = target;
                this.color = '#ff4500';
                this.width = 2;
                this.height = 10;
                this.speed = 10;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x - this.width / 2, this.y - this.height / 2, this.width, this.height);
            }

            update() {
                const angle = Math.atan2(this.target.y - this.y, this.target.x - this.x);
                this.x += Math.cos(angle) * this.speed;
                this.y += Math.sin(angle) * this.speed;
            }
        }

        function init() {
            resizeCanvas();
            player = new Player();
            enemies = [];
            bullets = [];
            particles = [];
            drones = [];
            droneLasers = [];
            score = 0;
            wave = 1;
            isGameOver = false;
            isGameRunning = false;
            isPaused = false;
            currentTarget = null;
            completedWordsThisGame = [];
            comboWordStreak = 0;
            comboKeyStreak = 0;
            updateUI();
            updateHealthUI();
            updateWordInfoPanel(null);
            updateCompletedWordsPanel();
            updateComboUI();
            gameLoop.isRunning = false;
        }

        function spawnWave() {
            const wordsForWave = allWords.filter(w => w.level <= wave);
            if (wordsForWave.length === 0) {
                console.error("目前關卡沒有可用的單字。請確認 'allWords' 陣列有內容。");
                return;
            }
            
            let enemyCount;
            if (wave < 4) {
                enemyCount = 8 + (wave * 2);
            } else {
                enemyCount = 8 + (4 * 2) + (wave - 4);
            }

            for (let i = 0; i < enemyCount; i++) {
                const wordData = wordsForWave[Math.floor(Math.random() * wordsForWave.length)];
                const x = Math.random() * (canvas.width - 80) + 40;
                const y = Math.random() * -canvas.height - 50;
                enemies.push(new Enemy(x, y, wordData));
            }
        }
        
        function createExplosion(x, y, color) {
            for (let i = 0; i < 20; i++) {
                particles.push(new Particle(x, y, color));
            }
        }

        function update() {
            if (isPaused || !isGameRunning || isGameOver) return;

            bullets.forEach((bullet, bIndex) => {
                bullet.update();
                const dist = Math.hypot(bullet.x - bullet.target.x, bullet.y - bullet.target.y);
                if (dist < bullet.target.height / 2) {
                    bullet.target.speed *= 0.75; 
                    createExplosion(bullet.x, bullet.y, '#ffffff');
                    bullets.splice(bIndex, 1);
                } else if (bullet.y < 0 || bullet.x < 0 || bullet.x > canvas.width) {
                    bullets.splice(bIndex, 1);
                }
            });

            drones.forEach(drone => drone.update());

            droneLasers.forEach((laser, laserIndex) => {
                laser.update();
                const dist = Math.hypot(laser.x - laser.target.x, laser.y - laser.target.y);

                if (dist < laser.target.height / 2) {
                    const enemyIndex = enemies.indexOf(laser.target);
                    if (enemyIndex > -1) {
                        score += enemies[enemyIndex].word.length * 10;
                        updateUI();
                        createExplosion(enemies[enemyIndex].x, enemies[enemyIndex].y, enemies[enemyIndex].color);
                        if (enemies[enemyIndex] === currentTarget) {
                            currentTarget = null;
                            updateWordInfoPanel(null);
                        }
                        enemies.splice(enemyIndex, 1);
                    }
                    droneLasers.splice(laserIndex, 1);
                } else if (laser.y < 0 || laser.y > canvas.height || laser.x < 0 || laser.x > canvas.width) {
                    droneLasers.splice(laserIndex, 1);
                }
            });

            enemies.forEach((enemy, eIndex) => {
                enemy.update();
                const dist = Math.hypot(enemy.x - player.x, enemy.y - player.y);
                if (dist < enemy.width / 2 + player.width / 2) {
                    if (enemy === currentTarget) {
                        currentTarget = null;
                        updateWordInfoPanel(null);
                    }
                    player.loseHealth();
                    enemies.splice(eIndex, 1);
                    createExplosion(enemy.x, enemy.y, enemy.color);
                } else if (enemy.y > canvas.height) {
                    if (enemy === currentTarget) {
                        currentTarget = null;
                        updateWordInfoPanel(null);
                    }
                    player.loseHealth();
                    enemies.splice(eIndex, 1);
                }
            });

            particles.forEach((particle, pIndex) => {
                if (particle.alpha <= 0) {
                    particles.splice(pIndex, 1);
                } else {
                    particle.update();
                }
            });

            if (enemies.length === 0 && isGameRunning) {
                nextWave();
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            player.draw();
            drones.forEach(drone => drone.draw());
            enemies.forEach(enemy => enemy.draw());
            bullets.forEach(bullet => bullet.draw());
            droneLasers.forEach(laser => laser.draw());
            particles.forEach(particle => particle.draw());
        }

        function gameLoop() {
            update();
            draw();
            if (!isGameOver) {
                requestAnimationFrame(gameLoop);
            }
        }
        
        function updateUI() {
            scoreEl.textContent = score;
            waveEl.textContent = wave;
        }
        
        function updateHealthUI() {
            playerHealthEl.innerHTML = '';
            playerHealthEl.className = 'flex items-center gap-1';
            for(let i = 0; i < player.maxHealth; i++) {
                const barSegment = document.createElement('div');
                barSegment.className = 'w-5 h-2 rounded-sm border';
                if (i < player.health) {
                    barSegment.classList.add('bg-cyan-400', 'border-cyan-400');
                } else {
                    barSegment.classList.add('bg-transparent', 'border-gray-600');
                }
                playerHealthEl.appendChild(barSegment);
            }
        }

        function updateWordInfoPanel(enemy) {
            if (enemy) {
                const wordObj = enemy.wordData;
                infoWordEl.textContent = wordObj.word;
                infoTranslationEl.textContent = wordObj.translation || '...';
            } else {
                infoWordEl.textContent = '---';
                infoTranslationEl.textContent = '---';
            }
        }
        
        function updateCompletedWordsPanel() {
            completedWordsListEl.innerHTML = '';
            [...completedWordsThisGame].reverse().forEach(wordObj => {
                const item = document.createElement('div');
                item.className = 'p-2 bg-gray-700 rounded';
                item.innerHTML = `
                    <p class="text-lg text-yellow-400">${wordObj.word}</p>
                    <p class="text-sm text-gray-300">${wordObj.translation}</p>
                `;
                completedWordsListEl.appendChild(item);
            });
        }

        function updateComboUI() {
            comboStreakEl.textContent = comboWordStreak;
        }

        function gameOver() {
            isGameOver = true;
            isGameRunning = false;
            currentTarget = null;
            updateWordInfoPanel(null);

            if (score > highScore) {
                highScore = score;
                localStorage.setItem('typingFighterHighScore', highScore);
                messageTitle.textContent = '新紀錄!';
            } else {
                messageTitle.textContent = '遊戲結束';
            }

            messageText.innerHTML = `你的分數: ${score}<br><br>歷史最高分: ${highScore}`;
            actionButton.textContent = '重新開始';
            messageModal.classList.remove('hidden');

            const newButton = actionButton.cloneNode(true);
            actionButton.parentNode.replaceChild(newButton, actionButton);
            actionButton = newButton;
            actionButton.addEventListener('click', startGame, { once: true });
        }
        
        function nextWave() {
            isGameRunning = false;
            wave++;
            updateUI();

            waveText.textContent = `WAVE ${wave}`;
            waveAnnouncer.classList.add('show');
            
            setTimeout(() => {
                waveAnnouncer.classList.remove('show');
                setTimeout(() => {
                    spawnWave();
                    isGameRunning = true;
                }, 500);
            }, 2000);
        }

        function togglePause() {
            isPaused = !isPaused;
            if (isPaused) {
                pauseOverlay.classList.remove('hidden');
            } else {
                pauseOverlay.classList.add('hidden');
            }
        }

        function triggerErrorFeedback() {
            gameContainer.classList.add('shake');
            setTimeout(() => gameContainer.classList.remove('shake'), 300);

            flashOverlay.classList.remove('opacity-0');
            flashOverlay.classList.add('opacity-50');
            setTimeout(() => {
                flashOverlay.classList.remove('opacity-50');
                flashOverlay.classList.add('opacity-0');
            }, 100);
        }

        function handleKeyPress(e) {
            const key = e.key.toLowerCase();

            if (key === 'delete') {
                if (isGameRunning && !isGameOver) {
                    togglePause();
                }
                return;
            }

            if (isPaused || isGameOver || !isGameRunning) return;

            if (!/^[a-z]$/.test(key)) return;

            if (!currentTarget) {
                const potentialTargets = enemies.filter(enemy =>
                    !enemy.isTargeted &&
                    enemy.word[0] === key &&
                    enemy.y > 0
                );

                if (potentialTargets.length > 0) {
                    potentialTargets.sort((a, b) => b.y - a.y);
                    currentTarget = potentialTargets[0];
                    currentTarget.isTargeted = true;
                    updateWordInfoPanel(currentTarget);
                    processHit(key);
                }
            } else {
                if (currentTarget.word[currentTarget.typedIndex] === key) {
                    processHit(key);
                } else {
                    triggerErrorFeedback();
                    comboKeyStreak = 0;
                    comboWordStreak = 0;
                    updateComboUI();
                }
            }
        }
        
        function processHit(key) {
            comboKeyStreak++;
            bullets.push(new Bullet(player.x, player.y, currentTarget));
            currentTarget.typedIndex++;

            if (currentTarget.typedIndex === currentTarget.word.length) {
                score += currentTarget.word.length * 10;
                updateUI();
                
                if (comboKeyStreak === currentTarget.word.length) {
                    comboWordStreak++;
                    updateComboUI();
                    
                    if (comboWordStreak === 10 && drones.length === 0) {
                        drones.push(new Drone(player));
                    } else if (comboWordStreak === 5) {
                        if (player.health < player.maxHealth) {
                            player.health++;
                            updateHealthUI();
                        } else {
                            player.hasShield = true;
                        }
                    }
                }
                comboKeyStreak = 0;
                
                completedWordsThisGame.push(currentTarget.wordData);
                updateCompletedWordsPanel();

                const enemyIndex = enemies.indexOf(currentTarget);
                if (enemyIndex > -1) {
                    createExplosion(currentTarget.x, currentTarget.y, currentTarget.color);
                    enemies.splice(enemyIndex, 1);
                }
                
                currentTarget = null;
                updateWordInfoPanel(null);
            }
        }
        
        function startGame() {
            messageModal.classList.add('hidden');
            init();
            spawnWave();
            isGameRunning = true;
            isGameOver = false;
            if (!gameLoop.isRunning) {
                gameLoop.isRunning = true;
                gameLoop();
            }
        }
        
        window.addEventListener('resize', () => {
            resizeCanvas();
            if(player) {
                player.x = canvas.width / 2;
                player.y = canvas.height - player.height - 30;
            }
        });
        document.addEventListener('keydown', handleKeyPress);
        
        window.onload = () => {
            init();
            messageModal.classList.remove('hidden');
            
            highScore = localStorage.getItem('typingFighterHighScore') || 0;
            highScoreEl.textContent = highScore;
            
            messageTitle.textContent = '遊戲規則';
            messageText.innerHTML = `
                1. 輸入敵機單字的第一個字母來鎖定目標。<br><br>
                2. 完整輸入單字即可將其擊落。<br><br>
                3. 連續完美擊落5個單字可獲得獎勵(回血/護盾)。<br><br>
                4. 連續完美擊落10個單字可獲得支援僚機!<br><br>
                5. 按下 <span class="text-yellow-400">[Delete]</span> 鍵可隨時暫停遊戲。
            `;
            actionButton.textContent = '開始挑戰';
            actionButton.addEventListener('click', startGame, { once: true });
        };
    </script>
</body>
</html>
